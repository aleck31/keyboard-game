<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ Pythonåç«¯é›†æˆæµ‹è¯•</title>
    <style>
        body {
            font-family: 'JetBrains Mono', monospace;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background: #0d1117;
            color: #f0f6fc;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            background: #21262d;
            border-radius: 8px;
            border: 1px solid #30363d;
        }
        .success { color: #4caf50; }
        .error { color: #f44336; }
        .info { color: #2196f3; }
        .warning { color: #ff9800; }
        button {
            background: #2196f3;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #1976d2; }
        .api-test {
            background: #161b22;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border-left: 4px solid #30363d;
        }
        .api-test.success { border-left-color: #4caf50; }
        .api-test.error { border-left-color: #f44336; }
        .api-test.loading { border-left-color: #ff9800; }
        .code-block {
            background: #0d1117;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #30363d;
            overflow-x: auto;
            font-family: 'JetBrains Mono', monospace;
            font-size: 12px;
            margin: 10px 0;
        }
        .architecture-diagram {
            background: #161b22;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            text-align: center;
        }
        .layer {
            background: #0d1117;
            padding: 15px;
            margin: 10px;
            border-radius: 8px;
            border: 2px solid #30363d;
        }
        .layer.frontend { border-color: #2196f3; }
        .layer.backend { border-color: #4caf50; }
        .layer.data { border-color: #ff9800; }
    </style>
</head>
<body>
    <h1>ğŸ Pythonåç«¯é›†æˆæµ‹è¯•</h1>
    
    <div class="test-section">
        <h2>ğŸ—ï¸ é¡¹ç›®æ¶æ„è¯´æ˜</h2>
        
        <div class="architecture-diagram">
            <h3>ä¸‰å±‚æ¶æ„è®¾è®¡</h3>
            
            <div class="layer frontend">
                <h4>ğŸ¨ å‰ç«¯å±‚ (Frontend)</h4>
                <ul style="text-align: left;">
                    <li><strong>Vue.js 3</strong> - å“åº”å¼UIæ¡†æ¶</li>
                    <li><strong>Vanilla JavaScript</strong> - æ¸¸æˆå¼•æ“é€»è¾‘</li>
                    <li><strong>HTML5/CSS3</strong> - ç•Œé¢å’Œæ ·å¼</li>
                    <li><strong>Web APIs</strong> - éŸ³é¢‘ã€å­˜å‚¨ç­‰</li>
                </ul>
            </div>
            
            <div style="font-size: 2rem; margin: 10px;">â¬‡ï¸ HTTP/REST API â¬‡ï¸</div>
            
            <div class="layer backend">
                <h4>ğŸ åç«¯å±‚ (Backend)</h4>
                <ul style="text-align: left;">
                    <li><strong>FastAPI</strong> - ç°ä»£Python Webæ¡†æ¶</li>
                    <li><strong>Pydantic</strong> - æ•°æ®éªŒè¯å’Œåºåˆ—åŒ–</li>
                    <li><strong>Uvicorn</strong> - ASGIæœåŠ¡å™¨</li>
                    <li><strong>é™æ€æ–‡ä»¶æœåŠ¡</strong> - å‰ç«¯èµ„æºæ‰˜ç®¡</li>
                </ul>
            </div>
            
            <div style="font-size: 2rem; margin: 10px;">â¬‡ï¸ File I/O â¬‡ï¸</div>
            
            <div class="layer data">
                <h4>ğŸ’¾ æ•°æ®å±‚ (Data)</h4>
                <ul style="text-align: left;">
                    <li><strong>JSONæ–‡ä»¶</strong> - é…ç½®å’Œæ•°æ®å­˜å‚¨</li>
                    <li><strong>æ¸¸æˆç»Ÿè®¡</strong> - æ€§èƒ½æ•°æ®è®°å½•</li>
                    <li><strong>å•è¯åº“</strong> - å¤šæ¨¡å¼æ–‡æœ¬æ•°æ®</li>
                    <li><strong>æ’è¡Œæ¦œ</strong> - ç©å®¶æˆç»©æ’å</li>
                </ul>
            </div>
        </div>
    </div>
    
    <div class="test-section">
        <h2>ğŸ”— å‰åç«¯é›†æˆæ–¹å¼</h2>
        
        <div class="info">
            <h3>é›†æˆç­–ç•¥</h3>
            <ul>
                <li><strong>å•ä¸€æœåŠ¡å™¨</strong>: Python FastAPIåŒæ—¶æä¾›APIå’Œé™æ€æ–‡ä»¶æœåŠ¡</li>
                <li><strong>RESTful API</strong>: å‰ç«¯é€šè¿‡HTTPè¯·æ±‚ä¸åç«¯é€šä¿¡</li>
                <li><strong>JSONæ•°æ®äº¤æ¢</strong>: ç»Ÿä¸€çš„æ•°æ®æ ¼å¼</li>
                <li><strong>å¼‚æ­¥å¤„ç†</strong>: å‰ç«¯å¼‚æ­¥è°ƒç”¨ï¼Œä¸é˜»å¡ç”¨æˆ·ç•Œé¢</li>
            </ul>
        </div>
        
        <div class="code-block">
# Pythonåç«¯ (FastAPI)
@app.get("/api/defense/words")
async def get_defense_words():
    """è·å–æ¤ç‰©é˜²å¾¡æ¨¡å¼å•è¯"""
    with open("data/defense_words.json", "r") as f:
        words = json.load(f)
    return {"status": "success", "data": words}

// JavaScriptå‰ç«¯ (APIè°ƒç”¨)
const response = await fetch('/api/defense/words');
const data = await response.json();
if (data.status === 'success') {
    this.wordsData = data.data;
}
        </div>
    </div>
    
    <div class="test-section">
        <h2>ğŸ§ª APIæ¥å£æµ‹è¯•</h2>
        
        <div class="api-test" id="basicApiTest">
            <h4>åŸºç¡€APIæµ‹è¯•</h4>
            <button onclick="testBasicAPIs()">æµ‹è¯•åŸºç¡€æ¥å£</button>
            <div id="basicApiResult"></div>
        </div>
        
        <div class="api-test" id="defenseApiTest">
            <h4>æ¤ç‰©é˜²å¾¡APIæµ‹è¯•</h4>
            <button onclick="testDefenseAPIs()">æµ‹è¯•æ¤ç‰©é˜²å¾¡æ¥å£</button>
            <div id="defenseApiResult"></div>
        </div>
        
        <div class="api-test" id="statsApiTest">
            <h4>ç»Ÿè®¡APIæµ‹è¯•</h4>
            <button onclick="testStatsAPIs()">æµ‹è¯•ç»Ÿè®¡æ¥å£</button>
            <div id="statsApiResult"></div>
        </div>
        
        <div class="api-test" id="analyticsApiTest">
            <h4>åˆ†æAPIæµ‹è¯•</h4>
            <button onclick="testAnalyticsAPI()">æµ‹è¯•åˆ†ææ¥å£</button>
            <div id="analyticsApiResult"></div>
        </div>
    </div>
    
    <div class="test-section">
        <h2>ğŸ“Š æ–°å¢çš„Python APIç«¯ç‚¹</h2>
        
        <div class="code-block">
<strong>æ¤ç‰©é˜²å¾¡æ¨¡å¼ä¸“ç”¨API:</strong>
GET  /api/defense/words           - è·å–æ¤ç‰©é˜²å¾¡å•è¯åº“
POST /api/defense/wave            - ç”Ÿæˆæ³¢æ¬¡é…ç½®
GET  /api/defense/config/{difficulty} - è·å–éš¾åº¦é…ç½®
POST /api/defense/stats           - ä¿å­˜æ¤ç‰©é˜²å¾¡ç»Ÿè®¡
GET  /api/defense/stats           - è·å–æ¤ç‰©é˜²å¾¡ç»Ÿè®¡
GET  /api/defense/leaderboard     - è·å–æ¤ç‰©é˜²å¾¡æ’è¡Œæ¦œ

<strong>åˆ†æå’Œç»Ÿè®¡API:</strong>
GET  /api/analytics               - è·å–æ¸¸æˆåˆ†ææ•°æ®

<strong>ç°æœ‰API (å·²å¢å¼º):</strong>
GET  /api/texts                   - è·å–ç»ƒä¹ æ–‡æœ¬
GET  /api/words                   - è·å–ç»ƒä¹ å•è¯
POST /api/stats                   - ä¿å­˜æ¸¸æˆç»Ÿè®¡
GET  /api/stats                   - è·å–æ¸¸æˆç»Ÿè®¡
GET  /api/leaderboard             - è·å–æ’è¡Œæ¦œ
        </div>
    </div>
    
    <div class="test-section">
        <h2>ğŸ’¾ æ•°æ®å­˜å‚¨ç»“æ„</h2>
        
        <div class="info">
            <h3>æ–°å¢æ•°æ®æ–‡ä»¶</h3>
            <ul>
                <li><strong>defense_words.json</strong> - æ¤ç‰©é˜²å¾¡æ¨¡å¼å•è¯åº“</li>
                <li><strong>defense_stats.json</strong> - æ¤ç‰©é˜²å¾¡æ¸¸æˆç»Ÿè®¡</li>
            </ul>
        </div>
        
        <div class="code-block">
// defense_words.json ç»“æ„
{
  "basic": ["cat", "dog", "run", ...],      // åŸºç¡€åƒµå°¸å•è¯
  "medium": ["house", "water", ...],        // ä¸­çº§åƒµå°¸å•è¯
  "strong": ["computer", "keyboard", ...],  // å¼ºåŠ›åƒµå°¸å•è¯
  "boss": ["extraordinary", ...]            // Bossåƒµå°¸å•è¯
}

// defense_stats.json ç»“æ„
{
  "score": 1250,
  "wave": 7,
  "total_waves": 10,
  "zombies_killed": 45,
  "plant_health": 65,
  "difficulty": "medium",
  "victory": false,
  "play_time": 180.5,
  "timestamp": "2025-06-08T15:30:00"
}
        </div>
    </div>
    
    <div class="test-section">
        <h2>ğŸš€ å¼€å§‹å®Œæ•´æµ‹è¯•</h2>
        <p>ç‚¹å‡»ä¸‹é¢çš„æŒ‰é’®å¼€å§‹æµ‹è¯•å®Œæ•´çš„å‰åç«¯é›†æˆï¼š</p>
        <button onclick="window.location.href='index.html'">ğŸ® å¯åŠ¨å®Œæ•´æ¸¸æˆ</button>
        <button onclick="window.location.href='test_defense_mode.html'">ğŸŒ± æ¤ç‰©é˜²å¾¡æµ‹è¯•</button>
        <button onclick="window.location.href='/docs'">ğŸ“š æŸ¥çœ‹APIæ–‡æ¡£</button>
        
        <div class="success" style="margin-top: 15px;">
            <h3>âœ… é›†æˆæµ‹è¯•æ­¥éª¤</h3>
            <ol>
                <li>æµ‹è¯•æ‰€æœ‰APIæ¥å£å“åº”</li>
                <li>éªŒè¯æ•°æ®å­˜å‚¨å’Œè¯»å–</li>
                <li>æµ‹è¯•æ¤ç‰©é˜²å¾¡æ¨¡å¼å®Œæ•´æµç¨‹</li>
                <li>æ£€æŸ¥ç»Ÿè®¡æ•°æ®ä¿å­˜</li>
                <li>éªŒè¯æ’è¡Œæ¦œåŠŸèƒ½</li>
                <li>æµ‹è¯•åˆ†ææ•°æ®ç”Ÿæˆ</li>
            </ol>
        </div>
    </div>

    <script>
        // APIæµ‹è¯•å‡½æ•°
        async function testBasicAPIs() {
            const testDiv = document.getElementById('basicApiTest');
            const resultDiv = document.getElementById('basicApiResult');
            
            testDiv.className = 'api-test loading';
            resultDiv.innerHTML = 'ğŸ”„ æµ‹è¯•ä¸­...';
            
            try {
                const tests = [
                    { name: 'è·å–ç»ƒä¹ æ–‡æœ¬', url: '/api/texts' },
                    { name: 'è·å–ç»ƒä¹ å•è¯', url: '/api/words' },
                    { name: 'è·å–æ¸¸æˆç»Ÿè®¡', url: '/api/stats' },
                    { name: 'è·å–æ’è¡Œæ¦œ', url: '/api/leaderboard' }
                ];
                
                const results = [];
                for (const test of tests) {
                    try {
                        const response = await fetch(test.url);
                        const data = await response.json();
                        results.push(`âœ… ${test.name}: ${data.status}`);
                    } catch (error) {
                        results.push(`âŒ ${test.name}: ${error.message}`);
                    }
                }
                
                testDiv.className = 'api-test success';
                resultDiv.innerHTML = results.join('<br>');
            } catch (error) {
                testDiv.className = 'api-test error';
                resultDiv.innerHTML = `âŒ æµ‹è¯•å¤±è´¥: ${error.message}`;
            }
        }
        
        async function testDefenseAPIs() {
            const testDiv = document.getElementById('defenseApiTest');
            const resultDiv = document.getElementById('defenseApiResult');
            
            testDiv.className = 'api-test loading';
            resultDiv.innerHTML = 'ğŸ”„ æµ‹è¯•ä¸­...';
            
            try {
                const tests = [
                    { name: 'è·å–æ¤ç‰©é˜²å¾¡å•è¯', url: '/api/defense/words' },
                    { name: 'è·å–ç®€å•éš¾åº¦é…ç½®', url: '/api/defense/config/easy' },
                    { name: 'è·å–æ¤ç‰©é˜²å¾¡ç»Ÿè®¡', url: '/api/defense/stats' },
                    { name: 'è·å–æ¤ç‰©é˜²å¾¡æ’è¡Œæ¦œ', url: '/api/defense/leaderboard' }
                ];
                
                const results = [];
                for (const test of tests) {
                    try {
                        const response = await fetch(test.url);
                        const data = await response.json();
                        results.push(`âœ… ${test.name}: ${data.status}`);
                    } catch (error) {
                        results.push(`âŒ ${test.name}: ${error.message}`);
                    }
                }
                
                // æµ‹è¯•æ³¢æ¬¡ç”Ÿæˆ
                try {
                    const waveResponse = await fetch('/api/defense/wave', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ difficulty: 'easy', wave: 1 })
                    });
                    const waveData = await waveResponse.json();
                    results.push(`âœ… ç”Ÿæˆæ³¢æ¬¡: ${waveData.status}`);
                } catch (error) {
                    results.push(`âŒ ç”Ÿæˆæ³¢æ¬¡: ${error.message}`);
                }
                
                testDiv.className = 'api-test success';
                resultDiv.innerHTML = results.join('<br>');
            } catch (error) {
                testDiv.className = 'api-test error';
                resultDiv.innerHTML = `âŒ æµ‹è¯•å¤±è´¥: ${error.message}`;
            }
        }
        
        async function testStatsAPIs() {
            const testDiv = document.getElementById('statsApiTest');
            const resultDiv = document.getElementById('statsApiResult');
            
            testDiv.className = 'api-test loading';
            resultDiv.innerHTML = 'ğŸ”„ æµ‹è¯•ä¸­...';
            
            try {
                // æµ‹è¯•ä¿å­˜æ¤ç‰©é˜²å¾¡ç»Ÿè®¡
                const testStats = {
                    score: 1000,
                    wave: 3,
                    total_waves: 4,
                    zombies_killed: 15,
                    plant_health: 80,
                    difficulty: 'easy',
                    victory: false,
                    play_time: 120.5
                };
                
                const saveResponse = await fetch('/api/defense/stats', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(testStats)
                });
                const saveData = await saveResponse.json();
                
                testDiv.className = 'api-test success';
                resultDiv.innerHTML = `âœ… ä¿å­˜æµ‹è¯•ç»Ÿè®¡: ${saveData.status}<br>âœ… æ¶ˆæ¯: ${saveData.message}`;
            } catch (error) {
                testDiv.className = 'api-test error';
                resultDiv.innerHTML = `âŒ æµ‹è¯•å¤±è´¥: ${error.message}`;
            }
        }
        
        async function testAnalyticsAPI() {
            const testDiv = document.getElementById('analyticsApiTest');
            const resultDiv = document.getElementById('analyticsApiResult');
            
            testDiv.className = 'api-test loading';
            resultDiv.innerHTML = 'ğŸ”„ æµ‹è¯•ä¸­...';
            
            try {
                const response = await fetch('/api/analytics');
                const data = await response.json();
                
                if (data.status === 'success') {
                    const analytics = data.data;
                    const result = `
                        âœ… åˆ†ææ•°æ®è·å–æˆåŠŸ<br>
                        ğŸ“Š æ€»æ¸¸æˆæ•°: ${analytics.total_games}<br>
                        ğŸ® ä¼ ç»Ÿæ¨¡å¼: ${analytics.traditional_games}<br>
                        ğŸŒ± æ¤ç‰©é˜²å¾¡: ${analytics.defense_games}
                    `;
                    
                    testDiv.className = 'api-test success';
                    resultDiv.innerHTML = result;
                } else {
                    throw new Error('åˆ†ææ•°æ®è·å–å¤±è´¥');
                }
            } catch (error) {
                testDiv.className = 'api-test error';
                resultDiv.innerHTML = `âŒ æµ‹è¯•å¤±è´¥: ${error.message}`;
            }
        }
        
        // é¡µé¢åŠ è½½å®Œæˆæç¤º
        window.addEventListener('load', () => {
            console.log('ğŸ Pythonåç«¯é›†æˆæµ‹è¯•é¡µé¢å·²åŠ è½½');
            console.log('ğŸ”— å‡†å¤‡æµ‹è¯•å‰åç«¯é›†æˆåŠŸèƒ½ï¼');
        });
    </script>
</body>
</html>
